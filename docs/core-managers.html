<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AuthTuna üêü - Asynchronous Security Framework</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/bash.min.js"></script>

    <style>
        :root {
            --primary: #8b5cf6; /* Indigo-500 */
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: #030712; /* Gray-950 */
        }
        /* Custom scrolling for content area */
        .doc-content-area::-webkit-scrollbar { width: 8px; }
        .doc-content-area::-webkit-scrollbar-thumb { background-color: #374151; border-radius: 4px; }
        .doc-content-area::-webkit-scrollbar-track { background: #1f2937; }

        /* Prose styling equivalent for generated content */
        .prose h1, .prose h2, .prose h3, .prose h4 {
            color: #f3f4f6; /* White */
            margin-top: 2rem;
            margin-bottom: 1rem;
        }
        .prose h1 { font-size: 2.5rem; font-weight: 800; }
        .prose h2 { font-size: 1.75rem; font-weight: 700; border-bottom: 1px solid #374151; padding-bottom: 0.5rem; }
        .prose h3 { font-size: 1.25rem; font-weight: 600; }
        .prose h4 { font-size: 1.1rem; font-weight: 600; color: #a5b4fc; }
        .prose p, .prose li { color: #d1d5db; line-height: 1.7; }
        .prose ul, .prose ol { list-style-type: disc; margin-left: 1.5rem; margin-bottom: 1rem; }
        .prose a { color: #a5b4fc; text-decoration: none; }
        .prose a:hover { text-decoration: underline; }
        .prose code {
            background-color: #1f2937; /* Gray-800 */
            padding: 0.2rem 0.4rem;
            border-radius: 0.375rem;
            color: #facc15; /* Amber-400 */
            font-size: 0.875rem;
        }
        .prose pre {
            background-color: #111827; /* Gray-900 */
            border: 1px solid #374151;
            padding: 1rem;
            border-radius: 0.5rem;
            overflow-x: auto;
            margin-top: 1rem;
            margin-bottom: 1rem;
        }
        .prose pre code {
            background: none;
            color: #e5e7eb; /* Gray-200 */
            padding: 0;
            font-size: 1rem;
        }
        .prose table { width: 100%; }
        .prose th { background-color: #1f2937; }
        .nav-link.active {
            background-color: var(--primary);
            color: white;
        }
    </style>
</head>
<body class="text-gray-200">

    <div class="flex h-screen overflow-hidden">

        <nav id="sidebar" class="w-64 bg-gray-900 p-6 border-r border-gray-800 flex-shrink-0 overflow-y-auto absolute md:relative transform -translate-x-full md:translate-x-0 transition-transform duration-200 ease-in-out z-30">
            <div class="sticky top-0 pb-6 bg-gray-900 z-10">
                <h1 class="text-3xl font-extrabold text-indigo-400">AuthTuna üêü</h1>
                <p class="text-sm text-gray-500 mt-1">v0.1.8 Docs</p>
            </div>

            <div class="space-y-2">
                <h2 class="text-lg font-semibold text-gray-400 mt-4 mb-2 uppercase tracking-wider">Fundamentals</h2>
                <a href="index.html" class="nav-link block p-2 rounded-lg transition-colors hover:bg-gray-800">
                    Introduction & Setup
                </a>
                <a href="configuration.html" class="nav-link block p-2 rounded-lg transition-colors hover:bg-gray-800">
                    Configuration (`Settings`)
                </a>
                <a href="core-managers.html" class="nav-link block p-2 rounded-lg transition-colors hover:bg-gray-800 active">
                    Core Service Layer
                </a>
                <a href="database-models.html" class="nav-link block p-2 rounded-lg transition-colors hover:bg-gray-800">
                    Database Models
                </a>

                <h2 class="text-lg font-semibold text-gray-400 mt-6 mb-2 uppercase tracking-wider">FastAPI Integration</h2>
                <a href="dependencies.html" class="nav-link block p-2 rounded-lg transition-colors hover:bg-gray-800">
                    Dependencies
                </a>
                <a href="permission-dependencies.html" class="nav-link block p-2 rounded-lg transition-colors hover:bg-gray-800">
                    Role & Permission Checks
                </a>
                 <a href="rbac-management.html" class="nav-link block p-2 rounded-lg transition-colors hover:bg-gray-800">
                    RBAC Management
                </a>

                <h2 class="text-lg font-semibold text-gray-400 mt-6 mb-2 uppercase tracking-wider">Built-in Features</h2>
                <a href="auth-flows.html" class="nav-link block p-2 rounded-lg transition-colors hover:bg-gray-800">
                    Authentication Flows
                </a>
                <a href="mfa.html" class="nav-link block p-2 rounded-lg transition-colors hover:bg-gray-800">
                    MFA & Social Login (SSO)
                </a>
                <a href="middleware-session.html" class="nav-link block p-2 rounded-lg transition-colors hover:bg-gray-800">
                    Middleware & Session Mgmt
                </a>
                 <a href="ui-dashboard.html" class="nav-link block p-2 rounded-lg transition-colors hover:bg-gray-800">
                    UI Dashboard
                </a>

            </div>
        </nav>

        <div id="overlay" class="fixed inset-0 bg-black bg-opacity-50 z-20 hidden md:hidden" onclick="toggleSidebar()"></div>

        <main class="flex-1 overflow-y-auto p-8 lg:p-12 doc-content-area">
             <button id="menu-button" class="md:hidden fixed top-4 right-4 bg-gray-800 p-2 rounded-lg z-40" onclick="toggleSidebar()">
                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
            </button>
            <div id="content" class="prose max-w-4xl mx-auto">
                <h1>Core Service Layer (`AuthTunaAsync`)</h1>
                <p>The entire library core is exposed through asynchronous manager classes. The main entry point is the <code>auth_service</code> instance from <code>authtuna.integrations</code>.</p>

                <h4>UserManager</h4>
                <p>Handles user lifecycle and data management.</p>
                <pre><code class="language-python"># Example: Suspending a user
from authtuna.integrations import auth_service

async def suspend(user_id, admin_id):
    suspended_user = await auth_service.users.suspend_user(
        user_id=user_id,
        admin_id=admin_id,
        reason="Violated ToS"
    )
    return suspended_user.is_active # Returns False
</code></pre>

                <h4>SessionManager</h4>
                <p>Directly manages database sessions, terminations, and retrieval.</p>
                <pre><code class="language-python"># Example: Terminate all other sessions for a user
async def cleanup_sessions(user_id, current_session_id, ip_address):
    await auth_service.sessions.terminate_all_for_user(
        user_id=user_id,
        ip_address=ip_address,
        except_session_id=current_session_id
    )
</code></pre>

                <h4>RoleManager & PermissionManager</h4>
                <p>Manages the RBAC system, including creating roles/permissions and assigning them.</p>
                <h5>Creating Roles and Permissions</h5>
                <pre><code class="language-python">
# Create a new role
await auth_service.roles.create("editor", "Can edit content", level=30) # do not set any role to level > 49 without understanding the hirearchial rbac system (curr have not yet documented in detail so please use caution when using this feature, i am already using in prod but its not documented so pls wait till using this feature, you may use the core auth system and existing roles which are provisioned by core.defaults)

# Create a new permission
await auth_service.permissions.create("edit:article", "Can edit articles") # same message as above.
                </code></pre>
                <h5>Adding Permissions to a Role</h5>
                <pre><code class="language-python">
# Add a permission to a role
await auth_service.roles.add_permission_to_role("editor", "edit:article") # this is more ok to use as less prone to escalation but caution anyway.
                </code></pre>
                <h5>Role Hierarchy and Levels</h5>
                <p>AuthTuna supports role hierarchy through a `level` system. A role with a higher level can manage roles with a lower level. For example, an `admin` with level 90 can assign the `editor` role with level 50 to a user.</p>
                <h5>Grant-Based System</h5>
                <p>In addition to the hierarchy, AuthTuna has a grant-based system. This allows you to explicitly grant a role the permission to assign other roles or grant specific permissions. This provides a more granular control over the RBAC system.</p>
                <pre><code class="language-python">
                        # will add example later
                </code></pre>
                <h5>Recommended Usage</h5>
                <p>For most applications, the built-in roles and permissions are sufficient. However, if you need to create custom roles and permissions, it's recommended to do so in a startup script or a dedicated management command. This ensures that your RBAC system is consistent and reproducible across all environments.</p>

                <h4>TokenManager</h4>
                <p>The `TokenManager` is responsible for creating, validating, and managing tokens for various purposes, such as email verification and password reset. You can use this manager to create custom tokens for your own features.</p>

                <h4>OrganizationManager</h4>
                <p>The `OrganizationManager` handles the logic for creating, managing, and inviting users to organizations. This is useful for multi-tenant applications where users are grouped into different organizations.</p>

            </div>
        </main>
    </div>
    <script>
        hljs.highlightAll();
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('overlay');
            sidebar.classList.toggle('-translate-x-full');
            sidebar.classList.toggle('translate-x-0');
            overlay.classList.toggle('hidden');
        }
    </script>
</body>
</html>
